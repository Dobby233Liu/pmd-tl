	;
	;Å@îƒópÇcÇhÇrÇjÉãÅ[É`ÉìÅ@ÇeÇnÇqÅ@ÇXÇW
	;

DISKREAD:
	;Å@INPUT ... FILENAME TOP to DS:AX
	;	     ADDRESS      to DS:DX
	;  OUTPUT... CX to LENGTH of FILE

	MOV	CS:[SPFOOK],SP

	; BP=FILENAME OFFSET ADDRESS
	MOV	BP,AX

	; FILE READ
	PUSH	DX
	CALL	OPNHND
	POP	DX

	CALL	REDHND
	PUSH	AX
	CALL	CLOHND
	POP	CX

	RET

;
;	DISK ∆ DATA ¶ ∂∑∫—
;
DISKWRITE:
	;Å@INPUT ... FILENAME TOP to DS:AX
	;	     ADDRESS      to DS:DX
	;	     LENGTH	  to CX

	MOV	CS:[SPFOOK],SP

	; BP=FILENAME OFFSET ADDRESS
	MOV	BP,AX

	PUSH	CX
	PUSH	DX
	CALL	MAKHND
	POP	DX
	POP	CX
	CALL	WRIHND
	CALL	CLOHND
	RET
;
;	OPEN HANDLE
;
OPNHND:	MOV	AX,3D02H
	MOV	DX,BP
	INT	21H
	JC	F_ERROR
	MOV	CS:[FHAND],AX
	RET
;
;	READ HANDLE
;
REDHND:
	MOV	CX,-1
	MOV	BX,CS:[FHAND]
	MOV	AH,3FH
	INT	21H
	JC	F_ERROR
	RET
;
;	CLOSE HANDLE
;
CLOHND:	MOV	AH,3EH
	MOV	BX,CS:[FHAND]
	INT	21H
	JC	F_ERROR
	RET
;
;	MAKE HANDLE
;
MAKHND:	MOV	AH,3CH
	MOV	DX,BP
	MOV	CX,0
	INT	21H
	JC	F_ERROR
	MOV	CS:[FHAND],AX
	RET
;
;	WRITE HANDLE
;	in. DX ADDRESS / CX LENGTH
;
WRIHND:	MOV	AH,40H
	MOV	BX,CS:[FHAND]
	INT	21H
	RET

F_ERROR:
	MOV	SP,CS:[SPFOOK]
	STC
	RET

FHAND	DW	0
SPFOOK	DW	0
